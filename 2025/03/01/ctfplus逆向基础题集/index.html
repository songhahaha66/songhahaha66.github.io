
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8" />
    <title> | songhahaha的个人博客</title>
    <meta name="author" content="songhahaha" />
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <meta
        name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"
    />
    <link rel="icon" href="/images/avatar.jpg" />
    <link rel="preconnect" href="https://s4.zstatic.net" />
<script src="https://s4.zstatic.net/ajax/libs/vue/3.3.7/vue.global.prod.min.js"></script>
<link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
<link rel="preconnect" href="https://fonts.googleapis.cn" />
<link rel="preconnect" href="https://fonts.gstatic.cn" crossorigin />
<link
    rel="stylesheet"
    href="https://fonts.googleapis.cn/css2?family=Fira+Code:wght@400;500;600;700&family=Lexend:wght@400;500;600;700;800;900&family=Noto+Sans+SC:wght@400;500;600;700;800;900&display=swap"
/>
<script> const mixins = {}; </script>

<script src="https://polyfill.alicdn.com/v3/polyfill.min.js?features=default"></script>


<script src="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://s4.zstatic.net/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
<link
    rel="stylesheet"
    href="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/styles/github.min.css"
/>
<script src="/js/lib/highlight.js"></script>



<script src="/js/lib/preview.js"></script>









<link rel="stylesheet" href="/css/main.css" />

<meta name="generator" content="Hexo 7.3.0"></head>
<body>
    <div id="layout">
        <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>加载过慢请开启缓存 浏览器默认开启</p>
                    <img src="/images/loading.gif" />
                </div>
            </div>
        </transition>
        <div id="menu" :class="{ hidden: hiddenMenu, 'menu-color': menuColor}">
    <nav id="desktop-menu">
        <a class="title" href="/">
            <span>SONGHAHAHA的个人博客</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
    </nav>
    <nav id="mobile-menu">
        <div class="title" @click="showMenuItems = !showMenuItems">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;SONGHAHAHA的个人博客</span>
        </div>
        <transition name="slide">
            <div class="items" v-show="showMenuItems">
                
                <a href="/">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-house fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                    </div>
                </a>
                
                <a href="/about">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-id-card fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                    </div>
                </a>
                
                <a href="/archives">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-box-archive fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                    </div>
                </a>
                
                <a href="/categories">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-bookmark fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                    </div>
                </a>
                
                <a href="/tags">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-tags fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                    </div>
                </a>
                
            </div>
        </transition>
    </nav>
</div>
<transition name="fade">
    <div id="menu-curtain" @click="showMenuItems = !showMenuItems" v-show="showMenuItems"></div>
</transition>

        <div id="main" :class="loading ? 'into-enter-from': 'into-enter-active'">
            <div class="article">
    <div>
        <h1></h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2025/3/1
        </span>
        
        
    </div>
    
    <div class="content" v-pre>
        <h1 id="simple1"><a href="#simple1" class="headerlink" title="simple1"></a>simple1</h1><p>先输入Name，sprintf将Name与v7异或后存在Buffer</p>
<p>之后输入Serial，比较Serial与Buffer。</p>
<p>已知Serial为5B134977135E7D13</p>
<p>经过测试发现v7并不是IDA分析给出的  qmemcpy(v7, “ 0”, sizeof(v7));</p>
<p>可以根据输入反推出v7为v7&#x3D;[16,32,48]。</p>
<p>然后得到正确name</p>
<p><img src="/images/ctfplus%E9%80%86%E5%90%91%E5%9F%BA%E7%A1%80%E9%A2%98%E9%9B%86/image-20241219214105405.png" alt="image-20241219214105405"></p>
<h1 id="simple2"><a href="#simple2" class="headerlink" title="simple2"></a>simple2</h1><p>看输出是RC3加密，其中s[i] !&#x3D; (char)(v8[i % v6 - 8] ^ v8[i])</p>
<p>这个ida又分析错了，实际上是(v7[i % v6]) ^ (v8[i])</p>
<p>附上解密代码</p>
<pre><code class="python">v6 = 7
v8 = [58, 34, 65, 76, 95, 82, 84, 94, 76, 42,
  46, 63, 43, 54, 47, 52, 54]
v7 = [104, 97, 114, 97, 109, 98, 101]
re = [0]*len(v8)
for i in range(len(v8)):
    re[i] =(v7[i % v6]) ^ (v8[i])
for i in range(len(v8)):
    print(chr(re[i]),end=&quot;&quot;)
</code></pre>
<h1 id="simple3"><a href="#simple3" class="headerlink" title="simple3"></a>simple3</h1><p>py逆向，使用pylingual无法反编译，但是使用uncompyle6就可以顺利反编译。</p>
<pre><code class="python"># uncompyle6 version 3.9.2
# Python bytecode version base 2.7 (62211)
# Decompiled from: Python 3.12.4 (tags/v3.12.4:8e8a4ba, Jun  6 2024, 19:30:16) [MSC v.1940 64 bit (AMD64)]
# Embedded file name: 1.py
# Compiled at: 2017-06-03 10:20:43
import base64

def encode(message):
    s = &#39;&#39;
    for i in message:
        x = ord(i) ^ 32
        x = x + 16
        s += chr(x)

    return base64.b64encode(s)


correct = &#39;XlNkVmtUI1MgXWBZXCFeKY+AaXNt&#39;
flag = &#39;&#39;
print &#39;Input flag:&#39;
flag = raw_input()
if encode(flag) == correct:
    print &#39;correct&#39;
else:
    print &#39;wrong&#39;

# okay decompiling simple3.pyc
</code></pre>
<p>很容易写出解密脚本</p>
<pre><code>import base64
a = &quot;XlNkVmtUI1MgXWBZXCFeKY+AaXNt&quot;
a = list(base64.b64decode(a))
for i in a:
    i = i-16
    i^=32
    print(chr(i),end=&quot;&quot;)
</code></pre>
<h1 id="simple4"><a href="#simple4" class="headerlink" title="simple4"></a>simple4</h1><p><img src="/images/ctfplus%E9%80%86%E5%90%91%E5%9F%BA%E7%A1%80%E9%A2%98%E9%9B%86/image-20241220114930767.png" alt="image-20241220114930767"></p>
<pre><code class="python">a = bytes.fromhex(&quot;437261636b4d654a757374466f7246756e&quot;)
print(a)
</code></pre>
<h1 id="simple5"><a href="#simple5" class="headerlink" title="simple5"></a>simple5</h1><pre><code class="c">for ( i = 0; i &lt; v5; ++i )
  &#123;
    Str[i] ^= v6;
    v6 = Str[i];
    if ( Str[i] != arr[i] )
      fun();
  &#125;
</code></pre>
<p>解密脚本</p>
<pre><code class="python">a = [0x55, 0x0F, 0x5E, 0x25, 0x6D, 0x2C, 0x7A, 0x3F, 0x60, 0x21,
  0x7E, 0x39, 0x76, 0x39, 0x7D, 0x22, 0x76, 0x3F, 0x72, 0x37,
  0x68, 0x49, 0x34]
b= [0]*23
a1= 19
for i in range(len(a)):
    b[i]=a[i] ^ a1
    a1 = a[i]
    print(chr(b[i]),end=&quot;&quot;)
</code></pre>
<h1 id="simple6"><a href="#simple6" class="headerlink" title="simple6"></a>simple6</h1><p><img src="/images/ctfplus%E9%80%86%E5%90%91%E5%9F%BA%E7%A1%80%E9%A2%98%E9%9B%86/image-20241220212806158.png" alt="image-20241220212806158"></p>
<p>写一个爆破脚本：</p>
<pre><code class="python">arr = [23, 22, 26, 26, 25, 25, 25, 26, 27, 28, 30, 30, 29, 30, 32, 32, 33, 32 ]
arr1 = [128,  169,  142,  225,  136,  189,  212,  165,  136,  191,  198,  153,  118,  171,  150,  175,  18,  203]
def baopo(arri,arr1i,i):
    for c in range(33, 127):
        dd = arri
        arri = c - arri % 17
        arri = 2 * arri - i
        if arri == arr1i:
            print(chr(c), end=&#39;&#39;)
        if arri != arr1i:
            arri=dd
for i in range(len(arr)):
    baopo(arr[i], arr1[i], i)
    print()
</code></pre>
<p>部分字符可能出现多解，能看出来正确字符是哪个</p>
<p>最后答案FZQ{Niu_Rou_Mian!}</p>
<h1 id="simple7"><a href="#simple7" class="headerlink" title="simple7"></a>simple7</h1><p>分析代码：</p>
<pre><code class="c">   v3 = (unsigned __int8)(flag[i] &gt;&gt; 7) &gt;&gt; 4;
    a = (char)(((v3 + (flag[i] &gt;&gt; 4)) &amp; 0xF) - v3);
    v4 = (unsigned int)((16 * flag[i]) &gt;&gt; 31) &gt;&gt; 28;
    b = (((_BYTE)v4 + (unsigned __int8)((16 * flag[i]) &gt;&gt; 4)) &amp; 0xF) - v4;
    c = 22 * a + 12 * b;
</code></pre>
<p>v3肯定是0</p>
<p>a是最高4位</p>
<p>b是最低4位</p>
<p>c是一个方程。遍历求解</p>
<p>附上解密脚本：</p>
<pre><code class="python">arr = [160,  230,  122,  286,  230,  144,  290,  208,  240,  144,  300,  216,  290,  244,  240,  100,  256,  310]
for c in arr:  # 已知的c值
    for H in range(16):
        for L in range(16):
            if 22 * H + 12 * L == c:
                flag_i = (H &lt;&lt; 4) | L
                print(chr(flag_i),end=&#39;&#39;)
                print()
</code></pre>
<h1 id="simple8"><a href="#simple8" class="headerlink" title="simple8"></a>simple8</h1><p>走迷宫问题，经典套路</p>
<h1 id="simple9"><a href="#simple9" class="headerlink" title="simple9"></a>simple9</h1><pre><code class="py"># uncompyle6 version 3.9.2
# Python bytecode version base 2.7 (62211)
# Decompiled from: Python 3.12.4 (tags/v3.12.4:8e8a4ba, Jun  6 2024, 19:30:16) [MSC v.1940 64 bit (AMD64)]
# Embedded file name: secend.py
# Compiled at: 2019-02-01 21:18:58
print &quot;Welcome to Processor&#39;s Python Classroom Part 2!\n&quot;
print &quot;Now let&#39;s start the origin of Python!\n&quot;
print &#39;Plz Input Your Flag:\n&#39;
enc = raw_input()
len = len(enc)
enc1 = []
enc2 = &#39;&#39;
aaa = &#39;ioOavquaDb&#125;x2ha4[~ifqZaujQ#&#39;
for i in range(len):
    if i % 2 == 0:
        enc1.append(chr(ord(enc[i]) + 1))
    else:
        enc1.append(chr(ord(enc[i]) + 2))

s1 = []
for x in range(3):
    for i in range(len):
        if (i + x) % 3 == 0:
            s1.append(enc1[i])

enc2 = enc2.join(s1)
if enc2 in aaa:
    print &quot;You &#39;re Right!&quot;
else:
    print &quot;You&#39;re Wrong!&quot;
    exit(0)

# okay decompiling simple9.pyc
</code></pre>
<p>还是pyc逆向，先是奇偶不同操作，然后打乱顺序生成s1，最后加密完是：ioOavquaDb}x2ha4[~ifqZaujQ#</p>
<p>解密脚本如下：</p>
<pre><code class="python">enc2 = &quot;ioOavquaDb&#125;x2ha4[~ifqZaujQ#&quot;
n = len(enc2)
idx = 0
enc1=[0]*n
re = []
for i in range(0, n, 3):
    enc1[i] = enc2[idx]
    idx += 1
for i in range(2, n, 3):
    enc1[i] = enc2[idx]
    idx += 1
for i in range(1, n, 3):
    enc1[i] = enc2[idx]
    idx += 1
for i in range(n):
    if i%2==0:
        re.append(chr(ord(enc1[i])-1))
    else:
        re.append(chr(ord(enc1[i])-2))
print(&#39;&#39;.join(re))
#hgame&#123;Now_Y0u_got_th3_PYC!&#125;
</code></pre>
<h1 id="simple15"><a href="#simple15" class="headerlink" title="simple15"></a>simple15</h1><p>第一步很简单的加密，但是也没有太大帮助。</p>
<p><img src="/images/ctfplus%E9%80%86%E5%90%91%E5%9F%BA%E7%A1%80%E9%A2%98%E9%9B%86/image-20241223001314805.png" alt="image-20241223001314805"></p>
<p>也就是命令行传入flag.txt，之后从flag.txt读取数据。</p>
<p>之后也很简单</p>
<p><img src="/images/ctfplus%E9%80%86%E5%90%91%E5%9F%BA%E7%A1%80%E9%A2%98%E9%9B%86/image-20241223001350405.png" alt="image-20241223001350405"></p>
<p>从这里读取数据减一换成hex就是，</p>
<p><img src="/images/ctfplus%E9%80%86%E5%90%91%E5%9F%BA%E7%A1%80%E9%A2%98%E9%9B%86/image-20241223001417739.png" alt="image-20241223001417739"></p>
<p>注意一下这里也定义了数组内容。</p>
<p>Geesec{4fc5f0e3e2e199a0a6ddd945aa2dfeda}</p>

    </div>
    
    
    
    
    
    
    
</div>

            <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2024 - 2025 songhahaha的个人博客
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;songhahaha
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/theme-particlex/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

        </div>
        
        <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
        </transition>
        
    </div>
    <script src="/js/main.js"></script>
    
    




    
</body>
</html>
